(function(h,B,g,t,O,v,c,d,H,_,$,j,w,E){"use strict";var b={translate:async function(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto",n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;try{if(r)return{source_lang:i,text:e};const a="https://translate.googleapis.com/translate_a/single?"+new URLSearchParams({client:"gtx",sl:i,tl:n,dt:"t",dj:"1",source:"input",q:e}),l=await fetch(a);if(!l.ok)throw new Error(`Failed to translate "${e}" (${i} -> ${n})
${l.status} ${l.statusText}`);const{src:N,sentences:x}=await l.json();return{source_lang:N,text:x.map(function(S){return S?.trans}).filter(Boolean).join("")}}catch(a){throw new Error(`Failed to fetch from Google Translate: ${a}`)}}};const C=g.findByProps("openLazy","hideActionSheet"),U=g.findByProps("ActionSheetRow")?.ActionSheetRow??d.Forms.FormRow,F=g.findByStoreName("MessageStore"),K=g.findByStoreName("ChannelStore"),Y=t.stylesheet.createThemedStyleSheet({iconComponent:{width:24,height:24,tintColor:v.semanticColors.INTERACTIVE_NORMAL}});let T=[];function z(){return O.before("openLazy",C,function(e){let[i,n,r]=e;const a=r?.message;n!=="MessageLongPressActionSheet"||!a||i.then(function(l){const N=O.after("default",l,function(x,S){t.React.useEffect(function(){return function(){N()}},[]);const R=H.findInReactTree(S,function(s){return s?.[0]?.type?.name==="ButtonRow"});if(!R)return;const ne=Math.max(R.findIndex(function(s){return s.props.message===t.i18n.Messages.MARK_UNREAD}),0),u=F.getMessage(a.channel_id,a.id);if(!u?.content&&!a.content)return;const I=u?.id??a.id,ie=u?.content??a.content,L=T.find(function(s){return Object.keys(s)[0]===I},"cache object"),M=L?"Revert":"Translate",G=M==="Translate"?c.getAssetIDByName("ic_locale_24px"):c.getAssetIDByName("ic_highlight"),re=async function(){try{const s=o.target_lang,m=M==="Translate",se=await b.translate(u.content,void 0,s,!m);t.FluxDispatcher.dispatch({type:"MESSAGE_UPDATE",message:{...u,content:`${m?se.text:L[I]} ${m?`\`[${s?.toLowerCase()}]\``:""}`,guild_id:K.getChannel(u.channel_id).guild_id},log_edit:!1}),m?T.unshift({[I]:ie}):T=T.filter(function(oe){return oe!==L},"cached data override")}catch(s){E.showToast("Failed to translate message. Please check Debug Logs for more info.",c.getAssetIDByName("Small")),_.logger.error(s)}finally{return C.hideActionSheet()}};R.splice(ne,0,t.React.createElement(U,{label:`${M} Message`,icon:t.React.createElement(U.Icon,{source:G,IconComponent:function(){return t.React.createElement(t.ReactNative.Image,{resizeMode:"cover",style:Y.iconComponent,source:G})}}),onPress:re}))})})})}var p;(function(e){e[e.BUILT_IN=0]="BUILT_IN",e[e.BUILT_IN_TEXT=1]="BUILT_IN_TEXT",e[e.BUILT_IN_INTEGRATION=2]="BUILT_IN_INTEGRATION",e[e.BOT=3]="BOT",e[e.PLACEHOLDER=4]="PLACEHOLDER"})(p||(p={}));var f;(function(e){e[e.SUB_COMMAND=1]="SUB_COMMAND",e[e.SUB_COMMAND_GROUP=2]="SUB_COMMAND_GROUP",e[e.STRING=3]="STRING",e[e.INTEGER=4]="INTEGER",e[e.BOOLEAN=5]="BOOLEAN",e[e.USER=6]="USER",e[e.CHANNEL=7]="CHANNEL",e[e.ROLE=8]="ROLE",e[e.MENTIONABLE=9]="MENTIONABLE",e[e.NUMBER=10]="NUMBER",e[e.ATTACHMENT=11]="ATTACHMENT"})(f||(f={}));var y;(function(e){e[e.CHAT=1]="CHAT",e[e.USER=2]="USER",e[e.MESSAGE=3]="MESSAGE"})(y||(y={}));const D={afrikaans:"AF",albanian:"SQ",amharic:"AM",armenian:"HY",assamese:"AS",aymara:"AY",azerbaijani:"AZ",bambara:"BM",basque:"EU",belarusian:"BE",bengali:"BN",bhojpuri:"BHO",bosnian:"BS",catalan:"CA",cebuano:"CEB",chichewa:"NY","chinese (simplified)":"ZH-CN","chinese (traditional)":"ZH-TW",corsican:"CO",croatian:"HR",dhivehi:"DV",dogri:"DOI",dutch:"NL",english:"EN",esperanto:"EO",estonian:"ET",ewe:"EE",filipino:"TL",finnish:"FI",french:"FR",frisian:"FY",galician:"GL",georgian:"KA",german:"DE",greek:"EL",guarani:"GN",gujarati:"GU","haitian creole":"HT",hausa:"HA",hawaiian:"HAW",hebrew:"IW",hindi:"HI",hmong:"HMN",hungarian:"HU",icelandic:"IS",igbo:"IG",ilocano:"ILO",indonesian:"ID",irish:"GA",italian:"IT",japanese:"JA",javanese:"JW",kannada:"KN",kazakh:"KK",khmer:"KM",kinyarwanda:"RW",konkani:"GOM",korean:"KO",krio:"KRI","kurdish (kurmanji)":"KU","kurdish (sorani)":"CKB",kyrgyz:"KY",lao:"LO",latin:"LA",latvian:"LV",lingala:"LN",lithuanian:"LT",luganda:"LG",luxembourgish:"LB",macedonian:"MK",maithili:"MAI",malagasy:"MG",malay:"MS",malayalam:"ML",maltese:"MT",maori:"MI","meiteilon (manipuri)":"MNI-MTEI",mizo:"LUS",mongolian:"MN","myanmar (burmese)":"MY",nepali:"NE",norwegian:"NO","odia (oriya)":"OR",oromo:"OM",pashto:"PS",persian:"FA",polish:"PL",portuguese:"PT",punjabi:"PA",quechua:"QU",romanian:"RO",russian:"RU",samoan:"SM",sanskrit:"SA","scots gaelic":"GD",sepedi:"NSO",serbian:"SR",sesotho:"ST",shona:"SN",sindhi:"SD",sinhala:"SI",slovak:"SK",slovenian:"SL",somali:"SO",spanish:"ES",sundanese:"SU",swahili:"SW",swedish:"SV",tajik:"TG",tamil:"TA",tatar:"TT",telugu:"TE",thai:"TH",tigrinya:"TI",tsonga:"TS",turkish:"TR",turkmen:"TK",twi:"AK",ukrainian:"UK",urdu:"UR",uyghur:"UG",uzbek:"UZ",vietnamese:"VI",welsh:"CY",xhosa:"XH",yiddish:"YI",yoruba:"YO",zulu:"ZU"},V=g.findByProps("sendBotMessage"),W=Object.entries(D).map(function(e){let[i,n]=e;return{name:i,displayName:i,value:n}});function q(){return $.registerCommand({name:"translate",displayName:"translate",description:"Send a message using Dislate in any language chosen, using the DeepL Translate API.",displayDescription:"Send a message using Dislate in any language chosen, using the DeepL Translate API.",applicationId:"-1",type:y.CHAT,inputType:p.BUILT_IN_TEXT,options:[{name:"text",displayName:"text",description:"The text/message for Dislate to translate. Please note some formatting of mentions and emojis may break due to the API.",displayDescription:"The text/message for Dislate to translate. Please note some formatting of mentions and emojis may break due to the API.",type:f.STRING,required:!0},{name:"language",displayName:"language",description:"The language that Dislate will translate the text into. This can be any language from the list.",displayDescription:"The language that Dislate will translate the text into. This can be any language from the list.",type:f.STRING,choices:[...W],required:!0}],async execute(e,i){const[n,r]=e;try{const a=await b.translate(n.value,null,r.value);return await new Promise(function(l){return j.showConfirmationAlert({title:"Are you sure you want to send it?",content:React.createElement(d.Codeblock,null,a.text),confirmText:"Yep, send it!",onConfirm:function(){return l({content:a.text})},cancelText:"Nope, don't send it"})})}catch(a){return _.logger.error(a),V.sendBotMessage(i.channel.id,"Failed to translate message. Please check Debug Logs for more info.",c.getAssetIDByName("Small"))}}})}const{FormRow:P}=d.Forms,{ScrollView:Z}=t.ReactNative;function X(){w.useProxy(o);const[e,i]=t.React.useState("");return t.React.createElement(Z,{style:{flex:1}},t.React.createElement(d.Search,{style:{padding:15},placeholder:"Search Language",onChangeText:function(n){i(n)}}),Object.entries(D).filter(function(n){let[r,a]=n;return r.includes(e)}).map(function(n){let[r,a]=n;return t.React.createElement(P,{label:r,trailing:function(){return t.React.createElement(P.Arrow,null)},onPress:function(){o.target_lang!=a&&(o.target_lang=a,E.showToast(`Saved ToLang to ${r}`,c.getAssetIDByName("check")))}})}))}const{ScrollView:J,Text:Q}=t.ReactNative,{FormRow:A}=d.Forms,ee=t.stylesheet.createThemedStyleSheet({subheaderText:{color:v.semanticColors.HEADER_SECONDARY,textAlign:"center",margin:10,marginBottom:50,letterSpacing:.25,fontFamily:t.constants.Fonts.PRIMARY_BOLD,fontSize:14}});function te(){const e=t.NavigationNative.useNavigation();return w.useProxy(o),t.React.createElement(J,null,t.React.createElement(A,{label:"Translate to",subLabel:o.target_lang?.toLowerCase(),leading:t.React.createElement(A.Icon,{source:c.getAssetIDByName("ic_activity_24px")}),trailing:function(){return t.React.createElement(A.Arrow,null)},onPress:function(){return e.push("VendettaCustomPage",{title:"Translate to",render:X})}}),t.React.createElement(Q,{style:ee.subheaderText,onPress:function(){return t.url.openURL("https://github.com/aeongdesu/vdplugins")}},`Build: (${B.manifest.hash.substring(0,7)})`))}const o=B.storage;o.target_lang??(o.target_lang="EN");let k=[];var ae={onLoad:function(){return k=[z(),q()]},onUnload:function(){for(const e of k)e()},settings:te};return h.default=ae,h.settings=o,Object.defineProperty(h,"__esModule",{value:!0}),h})({},vendetta.plugin,vendetta.metro,vendetta.metro.common,vendetta.patcher,vendetta.ui,vendetta.ui.assets,vendetta.ui.components,vendetta.utils,vendetta,vendetta.commands,vendetta.ui.alerts,vendetta.storage,vendetta.ui.toasts);
